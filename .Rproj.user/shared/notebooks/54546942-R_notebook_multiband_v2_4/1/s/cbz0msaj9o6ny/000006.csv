"0","#reshape the data with melt function and assign column names"
"0","colname<- c(""segments"", ""subject"", ""value"")"
"0","for (i in c(""mean"", ""max"")) {"
"0","  for (x in c(""ses1"", ""ses2"")) {"
"0","    nam_melt_dvars<- paste(""melt"",""segm"", i, x, ""dvars"", sep=""_"" )"
"0","  nam_dvars<- paste(""dvars"", i,""all"", x, sep=""_"" )"
"0"," assign(nam_melt_dvars, melt(get(nam_dvars)))"
"0"," #for adding the same column name in a for loop you need another variable which the initial variable assigned to with get function "
"0"," get_nam_melt_dvars<-get(nam_melt_dvars)"
"0","colnames(get_nam_melt_dvars)<- colname"
"0","assign(nam_melt_dvars,get_nam_melt_dvars)"
"0"," }"
"0","}"
"2","Using dvars_mean_all_ses1 as id variables
"
"2","Using dvars_mean_all_ses2 as id variables
"
"2","Using dvars_max_all_ses1 as id variables
"
"2","Using dvars_max_all_ses2 as id variables
"
"0","#rbind two melted dataframes of different sessions based on them being mean or max values"
"0","melt_segm_mean_ses12_dvars<- rbind(melt_segm_mean_ses1_dvars, melt_segm_mean_ses2_dvars)"
"0","melt_segm_max_ses12_dvars<- rbind(melt_segm_max_ses1_dvars, melt_segm_max_ses2_dvars)"
"0","# make the dataframe for lmer with volumetry"
"0","#first multiply the melted dataframes by there as you have three thresholds at volume data giving different outputs for each threshold"
"0","melt_max_ses12_expanded_dvars<- melt_segm_max_ses12_dvars[rep(1:nrow(melt_segm_max_ses12_dvars),each=3), 1:3]"
"0","melt_mean_ses12_expanded_dvars<- melt_segm_mean_ses12_dvars[rep(1:nrow(melt_segm_mean_ses12_dvars),each=3), 1:3]"
"0","#make the segments vector as character so that after cbinding this does not return numbers instead of strings"
"0","melt_max_ses12_expanded_dvars$segments<-as.character(melt_max_ses12_expanded_dvars$segments)"
"0","#make the dataframe consisting of vectors either from volumes_output or expended melt dataframes"
"0","lmer.df_dvars<-data.frame(volumes_output$Subject, melt_max_ses12_expanded_dvars$segments, volumes_output$Day,melt_mean_ses12_expanded$value, melt_max_ses12_expanded$value, melt_mean_ses12_expanded_dvars$value, melt_max_ses12_expanded_dvars$value, volumes_output$thr,   volumes_output$Volume, stringsAsFactors = FALSE)"
"0","colnames(lmer.df_dvars)<- c(""subject"", ""segment"", ""session"", ""hm_mean"", ""hm_max"",""hm_mean_dvars"", ""hm_max_dvars"", ""thr"", ""volume"")"
"0","#convert segments column from character to factor"
"0","lmer.df_dvars$segment<-as.factor(lmer.df$segment)"
"0","##PATIENTS WITH NO HYPOPERFUSION IN SESSION 1 AND 2"
"0","#pul subjects name assign it to a variable"
"0","subs_nohypo_1<-read.csv(paste(data_path, ""subs_nohypo_ses1"", sep=""/""),header=F)$V1"
"0","subs_nohypo_2<- read.csv(paste(data_path, ""subs_nohypo_ses2"", sep=""/""),header=F)$V1"
"0","#make vectors that are composed of segments name with two for loops"
"0","for (i in c(""mean"", ""max"")) {"
"0","  for (x in c(""ses1"", ""ses2"")) {"
"0","    nam_nohypo<- paste(""dvars"", i, ""nohypo"", x, sep=""_"")"
"0","    assign(nam_nohypo, segments)"
"0","    }"
"0","}"
"0","for (i in 1:length(subs_nohypo_1)) {"
"0","mean_seg_nohp_ses1_dvars <- c()"
"0","max_seg_nohp_ses1_dvars<- c()"
"0","      for (z in segments) {"
"0","        #read dvars files first for session_1"
"0","      z_i_dvars.txt<- read.csv(paste(data_path,subs_nohypo_1[i], ""session_1"", z, ""dvars.txt"", sep=""/""))"
"0","      nam_mean_z_dvars<- paste(subs_nohypo_1[i], x,""mean"",""dvars"", sep=""_"")"
"0","      #assign mean and max values to variables and rbind them with the empty vectors defined after the first for loop"
"0","      assign(nam_mean_z_dvars, mean(z_i_dvars.txt[,1]))"
"0","      nam_max_z_dvars<- paste(subs_nohypo_1[i], x, ""max"",""dvars"", sep=""_"")"
"0","    assign(nam_max_z_dvars, max(z_i_dvars.txt[,1]))"
"0","    mean_seg_nohp_ses1_dvars<- rbind(mean_seg_nohp_ses1_dvars, get(nam_mean_z_dvars))"
"0","    max_seg_nohp_ses1_dvars<-rbind(max_seg_nohp_ses1_dvars, get(nam_max_z_dvars))"
"0","      }"
"0"," #make data frames for mean and max data at ses1 with no hypoperfusion"
"0","  mean_seg_nohp_ses1_dvars <- data.frame(mean_seg_nohp_ses1_dvars)"
"0","  #give one volumn the name of the subject"
"0","  colnames(mean_seg_nohp_ses1_dvars) <- subs_nohypo_1[i]"
"0","  #cbind them with the vectors with the names of segments"
"0","  dvars_mean_nohypo_ses1 <- cbind(dvars_mean_nohypo_ses1, mean_seg_nohp_ses1_dvars)"
"0"," max_seg_nohp_ses1_dvars<- data.frame(max_seg_nohp_ses1_dvars)"
"0","  colnames(max_seg_nohp_ses1_dvars) <- subs_nohypo_1[i]"
"0"," dvars_max_nohypo_ses1<-cbind(dvars_max_nohypo_ses1, max_seg_nohp_ses1_dvars)"
"0","    "
"0","}"
"0","      "
"0","  for (i in 1:length(subs_nohypo_2)){"
"0","    mean_seg_nohp_ses2_dvars<- c()"
"0","    max_seg_nohp_ses2_dvars<- c()"
"0","    "
"0","    for(t in segments){"
"0","        #read dvars files for session_2 and do same thing for head motion mean and max calculation"
"0","        t_i_dvars.txt<- read.csv(paste(data_path, subs_nohypo_2[i], ""session_2"", t, ""dvars.txt"", sep=""/""))"
"0","        nam_mean_t_dvars<- paste(subs_nohypo_2[i], t, ""mean"",""dvars"", sep=""_"")"
"0","        assign(nam_mean_t_dvars, mean(t_i_dvars.txt[,1]))"
"0","        nam_max_t_dvars<- paste(subs_nohypo_2[i], t, ""max"",""dvars"", sep=""_"")"
"0","        assign(nam_max_t_dvars, max(t_i_dvars.txt[,1]))"
"0","    mean_seg_nohp_ses2_dvars<- rbind(mean_seg_nohp_ses2_dvars, get(nam_mean_t_dvars))"
"0","    max_seg_nohp_ses2_dvars<-rbind(max_seg_nohp_ses2_dvars, get(nam_max_t_dvars))"
"0","    }"
"0","    "
"0","    mean_seg_nohp_ses2_dvars<-data.frame(mean_seg_nohp_ses2_dvars) "
"0","  colnames(mean_seg_nohp_ses2_dvars) <- subs_nohypo_1[i]"
"0","dvars_mean_nohypo_ses2 <- cbind(dvars_mean_nohypo_ses2, mean_seg_nohp_ses2_dvars)"
"0","max_seg_nohp_ses2_dvars<- data.frame(max_seg_nohp_ses2_dvars)"
"0","  colnames(max_seg_nohp_ses2_dvars) <- subs_nohypo_1[i]"
"0","  dvars_max_nohypo_ses2<- cbind(dvars_max_nohypo_ses2, max_seg_nohp_ses2_dvars)"
"0","  }"
"0","  "
"0"," "
"0"," #get rid of the first column and give rownames as segment name to dataframes"
"0","for (i in c(""mean"", ""max"")) {"
"0","  for (x in c(""ses1"", ""ses2"")) {"
"0","  x_i_nohypo<- paste(""dvars"", i, ""nohypo"",x, sep=""_"")"
"0","  t<- get(x_i_nohypo)[,-1]"
"0","  rownames(t)<- segments"
"0","  assign(x_i_nohypo,t)"
"0","  }"
"0","}"
"0"," "
"0","#command above gives the output of dataframes  with 5 observations and 23 variables"
"0","#after transposing we have segments as colnames"
"0","dvars_mean_nohypo_final_1<- as.data.frame(t(dvars_mean_nohypo_ses1))"
"0","dvars_max_nohypo_final_1<- as.data.frame(t(dvars_max_nohypo_ses1))"
"0","dvars_mean_nohypo_final_2<- as.data.frame(t(dvars_mean_nohypo_ses2))"
"0","dvars_max_nohypo_final_2<- as.data.frame(t(dvars_max_nohypo_ses2))"
"0","#reshape the nohypoperfusion data with melt function"
"0","for (i in c(""mean"", ""max"")) {"
"0","  for (x in c(""1"", ""2"")) {"
"0","    "
"0","    nohypo_melt<- paste(""melt"", i, ""nohypo"", x, ""dvars"", sep=""_"")"
"0","    nohypo_melt_test<- paste(""dvars"", i, ""nohypo"", ""final"", x, sep=""_"")"
"0","    assign(nohypo_melt, melt(get(nohypo_melt_test)))"
"0","  }"
"0"," "
"0","  #reshape transposed with hypoperfusion data for the creation of the data frame for qualitative analysis mixed model, since there we need segments to be ordered as a bigger frame and subjects based on that"
"0","  #but in volume data segments were ordered for each subject"
"0","  for (z in c(""ses1"", ""ses2"")) {"
"0","    "
"0","    trans_withhypo_dvars<- paste(""trans"", i,z, ""dvars"", sep=""_"")"
"0","    melt_trans_dvars<- paste(""melt"", i, z,""dvars"", sep=""_"")"
"0","    assign(melt_trans_dvars, melt(get(trans_withhypo_dvars)))"
"0","  }"
"0","}"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"2","No id variables; using all as measure variables
"
"0","#had to subset data based on row numbers in order to adjust them to the excel sheet used by raters(excel sheet was organized in a way explained above)"
"0","max_test_dvars<- rbind(melt_max_ses1_dvars[173:215,], melt_max_nohypo_1_dvars[81:100,], melt_max_ses2_dvars[49:60,], melt_max_nohypo_2_dvars[93:115,], melt_max_ses1_dvars[130:172,], melt_max_nohypo_1_dvars[61:80,], melt_max_ses2_dvars[37:48,], melt_max_nohypo_2_dvars[70:92,], melt_max_ses1_dvars[87:129,], melt_max_nohypo_1_dvars[41:60,], melt_max_ses2_dvars[25:36,], melt_max_nohypo_2_dvars[47:69,], melt_max_ses1_dvars[44:86,], melt_max_nohypo_1_dvars[21:40,], melt_max_ses2_dvars[13:24,], melt_max_nohypo_2_dvars[24:46,],melt_max_ses1_dvars[1:43,], melt_max_nohypo_1_dvars[1:20,], melt_max_ses2_dvars[1:12,], melt_max_nohypo_2_dvars[1:23,]) "
"0","mean_test_dvars<- rbind(melt_mean_ses1_dvars[173:215,], melt_mean_nohypo_1_dvars[81:100,], melt_mean_ses2_dvars[49:60,], melt_mean_nohypo_2_dvars[93:115,], melt_mean_ses1_dvars[130:172,], melt_mean_nohypo_1_dvars[61:80,], melt_mean_ses2_dvars[37:48,], melt_mean_nohypo_2_dvars[70:92,], melt_mean_ses1_dvars[87:129,], melt_mean_nohypo_1_dvars[41:60,], melt_mean_ses2_dvars[25:36,], melt_mean_nohypo_2_dvars[47:69,], melt_mean_ses1_dvars[44:86,], melt_mean_nohypo_1_dvars[21:40,], melt_mean_ses2_dvars[13:24,], melt_mean_nohypo_2_dvars[24:46,],melt_mean_ses1_dvars[1:43,], melt_mean_nohypo_1_dvars[1:20,], melt_mean_ses2_dvars[1:12,], melt_mean_nohypo_2_dvars[1:23,]) "
