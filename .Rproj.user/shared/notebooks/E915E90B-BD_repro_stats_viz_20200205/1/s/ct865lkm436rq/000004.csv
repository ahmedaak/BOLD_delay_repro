"1","
"
"0","# SET FONT SIZE FOR PLOT TEXT"
"0","op <- par(cex = 1.2)"
"0","plot_text <- 10"
"0",""
"0","# plot distributions of diffvals by different variables"
"0","# VT"
"0","plot_vt <- ggplot(temp_df_subs, aes(diffvals, color=vt)) +"
"0","                           stat_density(geom=""line"", position = ""identity"", size = 1) +"
"0","                                  theme_classic(base_size = plot_text) + xlab(""Absolute differences (s)"") + ylab(""Density"") +"
"0","                                    theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","                                        scale_color_brewer(""Vascular territory"", type = ""qual"", palette = ""Set2"", labels = c(""ACA"",""MCA"",""PCA"")) "
"0",""
"0","# TYPE"
"0","plot_type <- ggplot(temp_df_subs, aes(diffvals, color=type)) +"
"0","                           stat_density(geom=""line"", position = ""identity"", size = 1) +"
"0","                                  theme_classic(base_size = plot_text) + xlab(""Absolute differences (s)"") + ylab(""Density"") +"
"0","                                      theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","                                        scale_color_brewer(""Group"", type = ""qual"", palette = ""Set2"", labels = c(""Healthy"",""Stroke""))"
"0",""
"0","# MAGNETIC FIELD STRENGTH"
"0","plot_tesla <- ggplot(temp_df_subs, aes(diffvals, color=field)) +"
"0","                           stat_density(geom=""line"", position = ""identity"", size = 1) +"
"0","                                  theme_classic(base_size = plot_text) + xlab(""Absolute differences (s)"") + ylab(""Density"") +"
"0","                                    theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","                                        scale_color_brewer(""Field strength"", type = ""qual"", palette = ""Set2"", labels = c(""3T"",""7T""))"
"0",""
"0","# CENSORING STRATEGY"
"0","plot_cens <- ggplot(temp_df_subs, aes(diffvals, color=cens)) +"
"0","                           stat_density(geom=""line"", position = ""identity"", size = 1) +"
"0","                                  theme_classic(base_size = plot_text) + xlab(""Absolute differences (s)"") + ylab(""Density"") +"
"0","                                  theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","                                        scale_color_brewer(""Motion censoring"", type = ""qual"", palette = ""Set2"", labels = c(""Yes"",""No""))"
"0",""
"0","# GENDER"
"0","plot_gender <- ggplot(temp_df_subs, aes(diffvals, color=gender)) +"
"0","                          stat_density(geom=""line"", position = ""identity"", size = 1) +"
"0","                                  theme_classic(base_size = plot_text) + xlab(""Absolute differences (s)"") + ylab(""Density"") +"
"0","                                    theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","                                        scale_color_brewer(""Gender"", type = ""qual"", palette = ""Set2"")"
"0",""
"0","# AGE"
"0","plot_age <- ggplot(temp_df_subs, aes(x=age, y=diffvals) ) +"
"0","geom_hex(bins = 32) + scale_fill_gradient(low = ""#fed976"", high = ""#800026"", trans = ""log10"") +"
"0","   xlab(""Age (years)"") +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  theme_bw() + "
"0","  theme(plot.margin=unit(c(0.3,0.5,0.3,1),""cm"")) +"
"0","  raincloud_theme"
"0",""
"0","# SET COLOR FOR RAINCLOUD PLOTS"
"0","rc_plot_col = ""dodgerblue"""
"0",""
"0","#STUDY"
"0","plot_study <- ggplot(data = temp_df_subs, aes(y = diffvals, x = as.factor(study), fill = as.factor(study))) +"
"0","geom_flat_violin(position = position_nudge(x = .2, y = 0), alpha = .8) +"
"0","geom_point(aes(y = diffvals, color = as.factor(study)), position = position_jitter(width = .15), size = .5, alpha = 0.8) +"
"0","geom_boxplot(width = .1, guides = FALSE, outlier.shape = NA, alpha = 0.5) +"
"0","expand_limits(x = 5.25) +"
"0","guides(fill = FALSE) +"
"0","guides(color = FALSE) +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  xlab(""Dataset"") +"
"0","  scale_color_brewer(palette = ""Dark2"") +"
"0","  scale_fill_brewer(palette = ""Dark2"") +"
"0","  scale_x_discrete(labels=dataset_names) +"
"0","theme_bw() +"
"0","  theme(plot.margin=unit(c(0.3,0,0.3,0.8),""cm"")) +"
"0","raincloud_theme"
"0",""
"0","# INTERVAL"
"0",""
"0","plot_int <- ggplot(data = temp_df_subs, aes(y = diffvals, x = as.factor(int), fill = as.factor(int))) +"
"0","geom_flat_violin(position = position_nudge(x = .2, y = 0), alpha = .8, fill = rc_plot_col) +"
"0","geom_point(aes(y = diffvals, color = as.factor(int)), position = position_jitter(width = .15), size = .5, alpha = 0.8, colour = ""gray52"") +"
"0","geom_boxplot(width = .1, guides = FALSE, outlier.shape = NA, alpha = 0.5, fill = rc_plot_col) +"
"0","expand_limits(x = 5.25) +"
"0","guides(fill = FALSE) +"
"0","guides(color = FALSE) +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  xlab(""Interval between scans (days)"") +"
"0","theme_bw() +"
"0","  theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","raincloud_theme"
"0",""
"0","# TR"
"0",""
"0","plot_tr <- ggplot(data = temp_df_subs, aes(y = diffvals, x = as.factor(tr), fill = as.factor(tr))) +"
"0","geom_flat_violin(position = position_nudge(x = .2, y = 0), alpha = .8, fill = rc_plot_col) +"
"0","geom_point(aes(y = diffvals, color = as.factor(tr)), position = position_jitter(width = .15), size = .5, alpha = 0.8, colour = ""gray52"") +"
"0","geom_boxplot(width = .1, guides = FALSE, outlier.shape = NA, alpha = 0.5, fill = rc_plot_col) +"
"0","expand_limits(x = 5.25) +"
"0","guides(fill = FALSE) +"
"0","guides(color = FALSE) +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  xlab(""Repetition time (s)"") +"
"0","theme_bw() +"
"0","  theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","raincloud_theme"
"0",""
"0","# SCAN LENGTH"
"0","plot_length <- ggplot(data = temp_df_subs, aes(y = diffvals, x = as.factor(length), fill = as.factor(length))) +"
"0","geom_flat_violin(position = position_nudge(x = .2, y = 0), alpha = .8, fill = rc_plot_col) +"
"0","geom_point(aes(y = diffvals), position = position_jitter(width = .15), size = .5, alpha = 0.6, colour = ""gray52"") +"
"0","geom_boxplot(width = .1, guides = FALSE, outlier.shape = NA, alpha = 0.5, fill = rc_plot_col) +"
"0","expand_limits(x = 5.25) +"
"0","guides(fill = FALSE) +"
"0","guides(color = FALSE) +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  xlab(""Scan length (s)"") +"
"0","theme_bw() +"
"0","theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","raincloud_theme"
"0",""
"0","# FD MEAN"
"0","plot_FDmean <- ggplot(temp_df_subs, aes(x=FDmean, y=diffvals) ) +"
"0","geom_hex(bins = 32) + scale_fill_gradient(low = ""#fed976"", high = ""#800026"", trans = ""log10"") +"
"0","  xlab(""Mean framewise displacement (mm)"") +"
"0","  ylab(""Abs. differences (s)"") +"
"0","  theme_bw() + "
"0","  theme(plot.margin=unit(c(0.3,0.3,0.3,1),""cm"")) +"
"0","  raincloud_theme"
"0",""
"0","# plot all "
"0","png(""Figure3.png"", width = 12, height =18, units = ""cm"", res = 300)"
"0","plot_grid(plot_age, plot_gender, plot_study, ncol = 1, labels = ""AUTO"")"
