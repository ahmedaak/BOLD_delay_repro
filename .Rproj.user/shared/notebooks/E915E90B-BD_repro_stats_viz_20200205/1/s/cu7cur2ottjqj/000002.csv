"0","# check if data already exists"
"0","if(!file.exists(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/ANALYSIS/temp_df_subs.csv"")) {"
"0",""
"0","# BUILD MIXED MODEL DATAFRAME"
"0","# get subject names"
"0","subs <- list.files(path= ""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/IMAGES/"", full.names = F, recursive = F)"
"0",""
"0","# create list of studies + their participants"
"0","csb_h <- c(""C01"", ""C02"", ""C03"", ""C04"", ""C05"", ""C06"", ""C07"", ""C08"", ""C09"", ""C10"", ""C11"", ""C12"")"
"0","csb_s <- c(""sub0024"",""sub0033"",""sub0045"",""sub0048"",""sub0050"",""sub0055"",""sub0057"",""sub0061"",""sub0066"",""sub0078"",""sub0080"",""sub0088"",""sub0090"",""sub0094"",""sub0096"",""sub0104"",""sub0106"",""sub0108"",""sub0110"",""sub0112"",""sub0114"",""sub0117"",""sub0121"",""sub0129"",""sub0131"",""sub0133"",""sub0135"",""sub0137"",""sub0140"",""sub0144"",""sub0146"")"
"0","msc <- c(""msc01"",""msc02"",""msc03"",""msc04"",""msc05"",""msc06"",""msc07"",""msc08"",""msc09"",""msc10"")"
"0","mpi <- c(""sub_01"",""sub_02"",""sub_03"",""sub_04"",""sub_05"",""sub_06"",""sub_07"",""sub_08"",""sub_09"",""sub_10"",""sub_11"",""sub_12"",""sub_13"",""sub_14"",""sub_15"",""sub_16"",""sub_17"",""sub_18"",""sub_19"",""sub_20"",""sub_21"",""sub_22"")"
"0","modaf <- c(""sub-04"",""sub-06"",""sub-07"",""sub-09"",""sub-12"",""sub-13"",""sub-17"",""sub-19"",""sub-20"",""sub-21"",""sub-23"",""sub-24"",""sub-26"")"
"0","yale <- c(""sub-032401"",""sub-032402"",""sub-032403"",""sub-032404"",""sub-032405"",""sub-032406"",""sub-032407"",""sub-032408"",""sub-032409"",""sub-032410"",""sub-032411"",""sub-032412"")"
"0","eegnf <- c(""sub-cont01"",""sub-cont02"",""sub-cont03"",""sub-cont04"",""sub-cont05"",""sub-cont06"",""sub-cont07"",""sub-cont08"",""sub-cont09"",""sub-cont10"",""sub-cont11"",""sub-cont12"",""sub-cont13"",""sub-cont14"",""sub-cont15"",""sub-cont16"",""sub-cont17"",""sub-cont18"",""sub-cont19"",""sub-cont20"",""sub-cont21"",""sub-cont22"",""sub-cont23"",""sub-cont24"",""sub-cont25"",""sub-cont26"")"
"0","tbi <- c(""sub-control01"",""sub-control02"",""sub-control03"",""sub-control04"",""sub-control05"",""sub-control06"",""sub-control07"",""sub-control08"",""sub-control09"",""sub-control10"",""sub-control11"",""sub-control12"")"
"0",""
"0","# read in demographics file"
"0","demogr <- read.csv2(file = paste(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/demographics.csv"", sep="";""), header = T)"
"0",""
"0","# loop through subjects"
"0","temp_df_subs <- c()"
"0","for(i in subs) {"
"0","  # loop through censoring"
"0","  temp_df_cens <- c()"
"0","  for (c in c(""cens"", ""nocens"")) {"
"0","    "
"0","    # loop through vascular territories"
"0","    temp_df_vt <- c()"
"0","    for (v in c(""aca"",""mca"",""pca"")) {"
"0","      "
"0","      # load values"
"0","      temp_vals_t <- read.table(file = paste(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/IMAGES/"",i,""/VALS/"",i,""_"",v,""_"",c,""_diff_vals_atlas.txt"", sep=""""), header = F)"
"0","      D0_vals <- read.table(file = paste(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/IMAGES/"",i,""/VALS/"",i,""_"",v,""_"",c,""_D0_vals_atlas.txt"", sep=""""), header = F)"
"0","      D0_vals <- D0_vals$V1"
"0","      D1_vals <- read.table(file = paste(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/IMAGES/"",i,""/VALS/"",i,""_"",v,""_"",c,""_D1_vals_atlas.txt"", sep=""""), header = F)"
"0","      D1_vals <- D1_vals$V1"
"0","      "
"0","       # get rid of zeros (i.e. ROIs not included in this specific VT)"
"0","      temp_vals <- temp_vals_t[temp_vals_t != 0]"
"0","      D0_vals <- D0_vals[temp_vals_t != 0]"
"0","      D1_vals <- D1_vals[temp_vals_t != 0]"
"0","      "
"0","      # assign values to variable named (subject_censoredornot_vascularterritory)"
"0","      assign(paste(i,c,v, sep=""_""), temp_vals)"
"0","      temp_var <- paste(i,c,v, sep=""_"")"
"0","      "
"0","      assign(paste(i,c,v,""D0"",sep=""_""), D0_vals)"
"0","      temp_D0 <- paste(i,c,v,""D0"",sep=""_"")"
"0","      "
"0","      assign(paste(i,c,v,""D1"",sep=""_""), D1_vals)"
"0","      temp_D1 <- paste(i,c,v,""D1"",sep=""_"")"
"0","      "
"0","      # add respective columns to dataframe that represents one subject's vascular territory difference values using one censoring strategy "
"0","      temp_df <- as.data.frame(get(temp_var))"
"0",""
"0","      "
"0","      temp_df$subject <- rep(i, length(get(temp_var)))"
"0","      temp_df$`get(temp_var)` <- c()"
"0","      temp_df$`get(temp_D0)` <- c()"
"0","      temp_df$`get(temp_D1)` <- c()"
"0","      "
"0","      # create columns for subject-specific info (age, etc)"
"0","      temp_df$age <- rep(demogr[demogr$subject==i,3], length(get(temp_var)))"
"0","      temp_df$gender <- rep(demogr[demogr$subject==i,4], length(get(temp_var)))"
"0","      temp_df$FDmean <- rep(demogr[demogr$subject==i,5], length(get(temp_var)))"
"0","      "
"0","      # create columns for other variables"
"0","      temp_df$cens <- rep(c, length(get(temp_var)))"
"0","      temp_df$vt <- rep(v, length(get(temp_var)))"
"0","      temp_df$diffvals <- get(temp_var)"
"0","      temp_df$D0 <- get(temp_D0)"
"0","      temp_df$D1 <- get(temp_D1)"
"0","      "
"0","      temp_df$study <- NA"
"0","      temp_df$type <- NA"
"0","      temp_df$int <- NA"
"0","      temp_df$tr <- NA"
"0","      temp_df$length <- NA"
"0","      temp_df$field <- NA"
"0","      "
"0","      "
"0","      # create dataframe of one subject's difference values using one censoring strategy for ALL vascular territories"
"0","      temp_df_vt <- rbind(temp_df_vt, temp_df)    "
"0","      "
"0","    }"
"0","    # create dataframe of one subject's difference values using ALL censoring strategies for ALL vascular territories"
"0","    temp_df_cens <- rbind(temp_df_cens, temp_df_vt) "
"0","    "
"0","    # assign subject to a study and create corresponding columns (with parameters, interval, etc)"
"0","    if (is.element(i, tbi)) {"
"0","      temp_df_cens$study <- rep(""tbi"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(90, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(2, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(300, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, eegnf)) {"
"0","      temp_df_cens$study <- rep(""eegnf"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(0.02, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(2, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(300, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, yale)) {"
"0","      temp_df_cens$study <- rep(""yale"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(7, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(1, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(360, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, modaf)) {"
"0","      temp_df_cens$study <- rep(""modaf"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(0.25, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(1.671, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(240, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, mpi)) {"
"0","      temp_df_cens$study <- rep(""mpi"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(7, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(3, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(900, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(7, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, msc)) {"
"0","      temp_df_cens$study <- rep(""msc"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(1, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(2.2, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(1800, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, csb_h)) {"
"0","      temp_df_cens$study <- rep(""csb_h"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""healthy"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(1, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(0.4, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(340, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","    if (is.element(i, csb_s)) {"
"0","      temp_df_cens$study <- rep(""csb_s"", nrow(temp_df_cens)) # NAME OF STUDY"
"0","      temp_df_cens$type <- rep(""stroke"", nrow(temp_df_cens))"
"0","      temp_df_cens$int <- rep(1, nrow(temp_df_cens)) # INTERVAL BETWEEN SCANS IN DAYS"
"0","      temp_df_cens$tr <- rep(0.4, nrow(temp_df_cens)) # REPETITION TIME IN SECONDS"
"0","      temp_df_cens$length <- rep(340, nrow(temp_df_cens)) # SCAN LENGTH IN SECONDS"
"0","      temp_df_cens$field <- rep(3, nrow(temp_df_cens)) # FIELD STRENGTH IN TESLA"
"0","    }"
"0","  }"
"0","  "
"0","  # create dataframe of ALL subjects' difference values using ALL censoring strategies for ALL vascular territories"
"0","  temp_df_subs <- rbind(temp_df_subs, temp_df_cens)"
"0","  "
"0","  # write dataframe to CSV file"
"0","  write.csv(temp_df_subs, ""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/ANALYSIS/temp_df_subs.csv"")"
"0","   }} else {"
"0","    # load in prepepared data"
"0","      temp_df_subs <- read.csv(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/ANALYSIS/temp_df_subs.csv"")"
"0","     demogr <- read.csv2(file = paste(""S:/AG/AG-CSB_NeuroRad2/khalila/PROJECTS/BD_REPRO/demographics.csv"", sep="";""), header = T)"
"0","   }"
"0","        "
"0",""
