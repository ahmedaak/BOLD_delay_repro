"0","# visualize results of model"
"0","#summary(model1)"
"0","# # build mixed model - Laplace approximation (NB: predictors scaled)"
"0","#         model2 <- glmer(diffvals ~ vt + type + FDmean + tr + I(int/10) + I(length/600) + cens + (1|subject) + (1|study), data = temp_df_subs, family = gaussian(link=""log""))"
"0","#         "
"0","#         summary(model2)"
"0","#         "
"0","#               # check for overdispersion (important with Laplace approximations)"
"0","#               overdisp_fun <- function(model) {"
"0","#                   ## number of variance parameters in an n-by-n variance-covariance matrix"
"0","#                   vpars <- function(m) {"
"0","#                       nrow(m) * (nrow(m) + 1)/2"
"0","#                   }"
"0","#                   # The next two lines calculate the residual degrees of freedom"
"0","#                   model.df <- sum(sapply(VarCorr(model), vpars)) + length(fixef(model))"
"0","#                   rdf <- nrow(model.frame(model)) - model.df"
"0","#                   # extracts the Pearson residuals"
"0","#                   rp <- residuals(model, type = ""pearson"")"
"0","#                   Pearson.chisq <- sum(rp^2)"
"0","#                   prat <- Pearson.chisq/rdf"
"0","#                   # Generates a p-value. If less than 0.05, the data are overdispersed."
"0","#                   pval <- pchisq(Pearson.chisq, df = rdf, lower.tail = FALSE)"
"0","#                   c(chisq = Pearson.chisq, ratio = prat, rdf = rdf, p = pval)"
"0","#               }"
"0","#               # checking for overdispersion"
"0","#               overdisp_fun(model2)"
"0","        "
"0","        # modelling overdispersion as a random effect - see https://peerj.com/articles/616/ and https://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html"
"0","        #model2b <- glmer(diffvals ~ vt + type + FDmean + tr + I(int/10) + I(length/600) + cens + (1|subject) + (1|X), data = temp_df_subs, family = gaussian(link=""log""))"
"0","        "
"0","        # ABOVE MODEL DOES NOT CONVERGE"
"0","# build mixed model - Penalized quasi-likelihood (NB: predictors scaled)"
"0","model3 <- glmmPQL(diffvals ~ vt + type + FDmean + tr + I(int/10) + I(length/600) + cens, random=list(study = ~1, subject = ~1), family = gaussian(link=""log""), data = temp_df_subs, verbose = FALSE)"
"0","summary(model3)"
"1","Linear mixed-effects model fit by "
"1","maximum likelihood
"
"1"," Data:"
"1"," "
"1","temp_df_subs"
"1"," "
"1","
"
"1"," "
"1"," AIC"
"1"," BIC"
"1"," logLik"
"1","
 "
"1","  NA"
"1","  NA"
"1","     NA"
"1","
"
"1","
"
"1","Random effects:
"
"1"," Formula: "
"1","~1"
"1"," | study"
"1","
"
"1","       "
"1"," (Intercept)"
"1","
StdDev:"
"1","  0.07138665"
"1","
"
"1","
"
"1"," Formula: "
"1","~1"
"1"," | subject %in% study"
"1","
"
"1","       "
"1"," (Intercept)"
"1"," Residual"
"1","
StdDev:"
"1","   0.2509282"
"1","  1.78033"
"1","
"
"1","
"
"1","Variance function:
"
"1"," Structure: fixed weights
"
"1"," Formula: ~invwt 
"
"1","Fixed effects: "
"1","diffvals ~ vt + type + FDmean + tr + I(int/10) + I(length/600) + "
"1"," "
"1","    cens"
"1"," "
"1","
"
"1","             "
"1","      Value"
"1"," Std.Error"
"1","     DF"
"1","   t-value"
"1"," p-value"
"1","
(Intercept)  "
"1","  1.2329385"
"1"," 0.0952679"
"1"," 128442"
"1","  12.94180"
"1","  0.0000"
"1","
vtpca        "
"1"," -0.2961406"
"1"," 0.0042940"
"1"," 128442"
"1"," -68.96628"
"1","  0.0000"
"1","
vtaca        "
"1"," -0.0947648"
"1"," 0.0035953"
"1"," 128442"
"1"," -26.35814"
"1","  0.0000"
"1","
typestroke   "
"1"," -0.0192312"
"1"," 0.1173073"
"1","      3"
"1","  -0.16394"
"1","  0.8802"
"1","
FDmean       "
"1","  0.6534910"
"1"," 0.3428033"
"1","    129"
"1","   1.90631"
"1","  0.0588"
"1","
tr           "
"1"," -0.0734139"
"1"," 0.0546083"
"1","      3"
"1","  -1.34437"
"1","  0.2714"
"1","
I(int/10)    "
"1","  0.0262556"
"1"," 0.0131628"
"1","      3"
"1","   1.99468"
"1","  0.1400"
"1","
I(length/600)"
"1"," -0.0558273"
"1"," 0.0533107"
"1","      3"
"1","  -1.04721"
"1","  0.3719"
"1","
censcens     "
"1","  0.0212445"
"1"," 0.0030515"
"1"," 128442"
"1","   6.96189"
"1","  0.0000"
"1","
"
"1"," Correlation:"
"1"," "
"1","
"
"1","             "
"1"," (Intr)"
"1"," vtpca "
"1"," vtaca "
"1"," typstr"
"1"," FDmean"
"1"," tr    "
"1"," I(/10)"
"1"," I(/600"
"1","
vtpca        "
"1"," -0.010"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","
vtaca        "
"1"," -0.012"
"1","  0.261"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","
typestroke   "
"1"," -0.572"
"1","  0.000"
"1","  0.000"
"1","       "
"1","       "
"1","       "
"1","       "
"1","       "
"1","
FDmean       "
"1"," -0.213"
"1","  0.000"
"1","  0.000"
"1"," -0.226"
"1","       "
"1","       "
"1","       "
"1","       "
"1","
tr           "
"1"," -0.694"
"1","  0.000"
"1","  0.000"
"1","  0.544"
"1"," -0.095"
"1","       "
"1","       "
"1","       "
"1","
I(int/10)    "
"1"," -0.096"
"1","  0.000"
"1","  0.000"
"1","  0.046"
"1"," -0.021"
"1"," -0.245"
"1","       "
"1","       "
"1","
I(length/600)"
"1"," -0.040"
"1","  0.000"
"1","  0.000"
"1"," -0.051"
"1"," -0.194"
"1"," -0.466"
"1","  0.299"
"1","       "
"1","
censcens     "
"1"," -0.016"
"1","  0.000"
"1","  0.000"
"1","  0.000"
"1","  0.000"
"1","  0.000"
"1","  0.000"
"1","  0.000"
"1","
"
"1","
Standardized Within-Group Residuals:
"
"1","       Min "
"1","        Q1 "
"1","       Med "
"1","        Q3 "
"1","       Max "
"1","
"
"1","-4.8961288 "
"1","-0.6109338 "
"1","-0.1551456 "
"1"," 0.4127629 "
"1"," 8.1759364 "
"1","
"
"1","
Number of Observations:"
"1"," "
"1","128583"
"1","
Number of Groups: "
"1","
"
"1","             study "
"1","subject %in% study "
"1","
"
"1","                 8 "
"1","               138 "
"1","
"
